<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sticky Notes Ultra Pro Max</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}

body{
    background:linear-gradient(135deg,#e0eafc,#cfdef3);
    min-height:100vh;
    transition:0.3s;
}

/* HEADER */
header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px 40px;
}

.header-right{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
}

button{
    padding:8px 14px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:500;
}

.primary-btn{background:#6c63ff;color:white;}
.primary-btn:hover{background:#574fd6;}

input{
    padding:8px;
    border-radius:8px;
    border:1px solid #ccc;
}

/* GRID */
main{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:20px;
    padding:30px 40px;
}

/* NOTE */
.note{
    padding:20px;
    border-radius:16px;
    box-shadow:0 10px 25px rgba(0,0,0,0.08);
    position:relative;
    transition:0.2s;
}
.note:hover{transform:translateY(-5px);}

.note small{
    position:absolute;
    bottom:10px;
    right:15px;
    font-size:11px;
}

.actions{
    position:absolute;
    top:10px;
    right:10px;
    font-size:13px;
}
.actions span{
    margin-left:8px;
    cursor:pointer;
}

/* MODAL */
.modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.4);
    display:flex;
    justify-content:center;
    align-items:center;
}
.hidden{display:none;}

.modal-box{
    background:white;
    width:500px;
    padding:20px;
    border-radius:20px;
}

/* SCROLLABLE EDITOR */
.editor{
    height:180px;
    overflow-y:auto;
    border:1px solid #ccc;
    padding:10px;
    border-radius:10px;
    margin-bottom:10px;
}

/* DARK MODE */
body.dark{
    background:#121212;
    color:white;
}
body.dark .modal-box{background:#2a2a2a;}
</style>
</head>

<body>

<header>
<h2>üåà Sticky Notes Ultra Pro Max</h2>
<div class="header-right">
<input type="text" id="search" placeholder="Search..." oninput="render()">
<button onclick="exportPDF()">üìÑ Export</button>
<button class="primary-btn" onclick="openModal()">+ Add</button>
<button onclick="toggleDark()">üåô</button>
</div>
</header>

<main id="notes"></main>

<div id="modal" class="modal hidden">
<div class="modal-box">

<input id="title" placeholder="Title">
<input id="category" placeholder="Category / Tag">

<label>Background Color:</label>
<input type="color" id="noteColor">
<br><br>

<!-- TOOLBAR -->
<div style="margin:10px 0; display:flex; gap:8px; align-items:center;">
<button onclick="format('bold')"><b>B</b></button>
<button onclick="format('italic')"><i>I</i></button>
<button onclick="format('underline')"><u>U</u></button>

<label style="font-size:12px;">Text:</label>
<input type="color" onchange="changeTextColor(this.value)">

<button onclick="startVoice()">üé§</button>
<button onclick="speakText()">üîä</button>
<input type="file" id="imageUpload" accept="image/*">
</div>

<div id="content" contenteditable="true" class="editor"></div>

<input type="password" id="notePassword" placeholder="Password (optional)">

<div style="display:flex;justify-content:flex-end;gap:10px;">
<button id="deleteInside" style="display:none;background:red;color:white;" onclick="deleteNote(editIndex)">Delete</button>
<button onclick="closeModal()">Cancel</button>
<button class="primary-btn" onclick="saveNote()">Save</button>
</div>

</div>
</div>

<script>
let notes = JSON.parse(localStorage.getItem("notesUltra")) || [];
let editIndex=null;

const modal=document.getElementById("modal");
const notesDiv=document.getElementById("notes");
const deleteInside=document.getElementById("deleteInside");

function openModal(note=null,index=null){
modal.classList.remove("hidden");

if(note){
if(note.password){
let pass=prompt("Enter Password:");
if(pass!==atob(note.password)){
alert("Wrong Password");
closeModal();
return;
}
deleteInside.style.display="inline-block";
}else{
deleteInside.style.display="inline-block";
}

title.value=note.title;
category.value=note.category;
content.innerHTML=note.content;
noteColor.value=note.color;
notePassword.value="";
editIndex=index;

}else{
title.value="";
category.value="";
content.innerHTML="";
notePassword.value="";
noteColor.value="#ffffff";
deleteInside.style.display="none";
editIndex=null;
}
}

function closeModal(){
modal.classList.add("hidden");
}

function saveNote(){
let data={
title:title.value,
category:category.value,
content:content.innerHTML,
color:noteColor.value,
date:new Date().toLocaleString(),
password:notePassword.value?btoa(notePassword.value):null,
pinned:false
};

if(editIndex!==null) data.pinned=notes[editIndex].pinned;

if(editIndex!==null) notes[editIndex]=data;
else notes.push(data);

localStorage.setItem("notesUltra",JSON.stringify(notes));
render();
closeModal();
}

function render(){
let searchValue=document.getElementById("search").value.toLowerCase();
notesDiv.innerHTML="";

notes.sort((a,b)=>b.pinned-a.pinned);

notes.forEach((n,i)=>{
if(searchValue && !n.title.toLowerCase().includes(searchValue)
&& !n.content.toLowerCase().includes(searchValue)
&& !n.category.toLowerCase().includes(searchValue)) return;

let div=document.createElement("div");
div.className="note";
div.style.background=n.color;

div.innerHTML=`
<div class="actions">
üìå <span onclick="togglePin(${i})">${n.pinned?"Unpin":"Pin"}</span>
‚úè <span onclick="openModal(notes[${i}],${i})">Edit</span>
${!n.password?`üóë <span onclick="deleteNote(${i})">Delete</span>`:''}
</div>
<h3>${n.title}</h3>
<p style="font-size:12px;">#${n.category}</p>
<div>${n.password?"üîê Locked Note":n.content}</div>
<small>${n.date}</small>
`;

notesDiv.appendChild(div);
});
}

function deleteNote(i){
if(confirm("Delete this note?")){
notes.splice(i,1);
localStorage.setItem("notesUltra",JSON.stringify(notes));
render();
closeModal();
}
}

function togglePin(i){
notes[i].pinned=!notes[i].pinned;
localStorage.setItem("notesUltra",JSON.stringify(notes));
render();
}

function format(cmd){
document.execCommand(cmd,false,null);
}

function changeTextColor(color){
document.execCommand("foreColor",false,color);
}

function startVoice(){
let SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;
let recognition=new SpeechRecognition();
recognition.lang="en-US";
recognition.start();
recognition.onresult=(e)=>content.innerHTML+=e.results[0][0].transcript+" ";
}

function speakText(){
let speech=new SpeechSynthesisUtterance(content.innerText);
speechSynthesis.speak(speech);
}

document.getElementById("imageUpload").onchange=function(){
let file=this.files[0];
let reader=new FileReader();
reader.onload=()=>content.innerHTML+=`<img src="${reader.result}" style="max-width:100%;margin-top:8px;border-radius:10px;">`;
reader.readAsDataURL(file);
};

function toggleDark(){
document.body.classList.toggle("dark");
}

function exportPDF(){
const { jsPDF } = window.jspdf;
let doc=new jsPDF();
let y=10;
notes.forEach(n=>{
doc.text(n.title,10,y); y+=8;
doc.text(n.category,10,y); y+=8;
doc.text(n.content.replace(/<[^>]*>/g,''),10,y); y+=15;
});
doc.save("StickyNotes.pdf");
}

render();
</script>

</body>
</html>
